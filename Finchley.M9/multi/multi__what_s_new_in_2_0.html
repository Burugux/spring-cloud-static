<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>26.&nbsp;What&#8217;s New in 2.0?</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="multi_spring-cloud.html" title="Spring Cloud"><link rel="up" href="multi__spring_cloud_stream.html" title="Part&nbsp;V.&nbsp;Spring Cloud Stream"><link rel="prev" href="multi__quick_start_2.html" title="25.&nbsp;Quick Start"><link rel="next" href="multi__introducing_spring_cloud_stream.html" title="27.&nbsp;Introducing Spring Cloud Stream"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">26.&nbsp;What&#8217;s New in 2.0?</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="multi__quick_start_2.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;Spring Cloud Stream</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="multi__introducing_spring_cloud_stream.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="_what_s_new_in_2_0" href="#_what_s_new_in_2_0"></a>26.&nbsp;What&#8217;s New in 2.0?</h2></div></div></div><p>Spring Cloud Stream introduces quite a number of new features, enhancements and changes. The following sections outline most notable ones.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_new_features_and_components" href="#_new_features_and_components"></a>26.1&nbsp;New Features and Components</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_polling_consumer" href="#_polling_consumer"></a>26.1.1&nbsp;Polling Consumer</h3></div></div></div><p>Introduction of <span class="emphasis"><em>polled consumers</em></span>, where the application can control message processing rates. Please refer to the appropriate section for more details.
You can also read this blog for more details <a class="link" href="https://spring.io/blog/2018/02/27/spring-cloud-stream-2-0-polled-consumers" target="_top">https://spring.io/blog/2018/02/27/spring-cloud-stream-2-0-polled-consumers</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_micrometer_support" href="#_micrometer_support"></a>26.1.2&nbsp;Micrometer support</h3></div></div></div><p>Metrics has been switched to use <a class="link" href="https://micrometer.io/" target="_top">Micrometer</a>. <code class="literal">MeterRegistry</code> is also provided as a bean so custom application can autowire it to capture custom metrics.
Please refer to the appropriate section for more details</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_new_actuator_binding_controls" href="#_new_actuator_binding_controls"></a>26.1.3&nbsp;New Actuator Binding controls</h3></div></div></div><p>There are now new new Actuator binding controls to both visualize as well as control Bindings lifecycle. For more details please visit <a class="xref" href="multi__binders.html#_binding_visualization_and_control" title="30.6&nbsp;Binding visualization and control">Section&nbsp;30.6, &#8220;Binding visualization and control&#8221;</a></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configurable_retrytemplate" href="#_configurable_retrytemplate"></a>26.1.4&nbsp;Configurable RetryTemplate</h3></div></div></div><p>Aside from providing properties to configure <code class="literal">RetryTemplate</code> we now allow you to provide your own effectively overriding the one provided by the framework. Simply configure
it as a <code class="literal">@Bean</code> in your application.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_notable_changes_and_enhancements" href="#_notable_changes_and_enhancements"></a>26.2&nbsp;Notable changes and enhancements</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_both_actuator_and_web_dependencies_are_now_optional" href="#_both_actuator_and_web_dependencies_are_now_optional"></a>26.2.1&nbsp;Both Actuator and Web dependencies are now optional</h3></div></div></div><p>This helps to slim down the footprint of the deployed application in the event neither of the functionality is required.
It also allows one to swicth between the reactive and conventional web paradigms by adding one of the following dependencies manually:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.boot<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-boot-starter-web<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>or</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.boot<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-boot-starter-webflux<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>Actuator dependency can be added as follows:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.boot<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_content_type_negotiation_improvenents" href="#_content_type_negotiation_improvenents"></a>26.2.2&nbsp;Content-type negotiation improvenents</h3></div></div></div><p>One of the core themes for 2.0 is improvements (both consistency and performance) around content-type negotiation and message conversion.
The following summary outlines notable changes and improvements. Please refer to the appropriate section for more details as well as this blog
<a class="link" href="https://spring.io/blog/2018/02/26/spring-cloud-stream-2-0-content-type-negotiation-and-transformation" target="_top">https://spring.io/blog/2018/02/26/spring-cloud-stream-2-0-content-type-negotiation-and-transformation</a>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">All message conversion is now handled <span class="strong"><strong>only</strong></span> by <code class="literal">MessageConverters</code>.</li><li class="listitem">Introduction of <code class="literal">@StreamMessageConverter</code> annotation to provide custom <code class="literal">MessageConverters</code>.</li><li class="listitem">Introduction of the default <span class="emphasis"><em>Content Type</em></span> as <code class="literal">application/json</code> which needs to be taken into consideration when migrating 1.3
application and/or operating in the mixed mode (i.e., 1.3 producer &#8594; 2.0 consumer).</li><li class="listitem">Messages with textual payloads and <span class="emphasis"><em>contentType</em></span> <code class="literal">text/&#8230;&#8203;</code> or <code class="literal">&#8230;&#8203;/json</code> are no longer converted to <code class="literal">Message&lt;String&gt;</code> for cases where argument type of the provided <code class="literal">MessageHandler</code>
can not be determnied (i.e., <code class="literal">public void handle(Message&lt;?&gt; message)</code> or <code class="literal">public void handle(Object payload)</code>). Further more, a strong argument type may not be enough
to properly convert messages, so <code class="literal">contentType</code> header is may be used as supplement by some <code class="literal">MessageConverters</code>.</li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_notable_deprecations" href="#_notable_deprecations"></a>26.3&nbsp;Notable Deprecations</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_java_serialization_java_native_and_kryo" href="#_java_serialization_java_native_and_kryo"></a>26.3.1&nbsp;Java serialization (Java native and Kryo)</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">JavaSerializationMessageConverter</code> and <code class="literal">KryoMessageConverter</code>. While these two converters remain for now, they will be moved out of the core packages and support in the future.
The main reason for this deprecation is to signal the issue <span class="emphasis"><em>type-based language-specific</em></span> serialization couuld  cause in the distributed environments, where Producers and Consumers
may not only depend on different JVM versions or have different versions of supporting libraries (i.e., Kryo), but to also draw the attention to the fact that Consumers and Producers
may and in a lot of cases are non-Java based.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_deprecated_classes_and_methods" href="#_deprecated_classes_and_methods"></a>26.3.2&nbsp;Deprecated classes and methods</h3></div></div></div><p>Following is a quick summary of notable deprecations. See corresponding javadocs fort more details.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">SharedChannelRegistry</code> in favor of <code class="literal">SharedBindingTargetRegistry</code>.</li><li class="listitem"><code class="literal">Bindings</code> - beans qualified by it are already uniquely identified by their type. For example, provided <code class="literal">Source</code>, <code class="literal">Processor</code> or custom bindings:</li></ul></div><pre class="screen">public interface Foo {
	String OUTPUT = "fooOutput";

	@Output(Foo.OUTPUT)
	MessageChannel output();
}</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">HeaderMode.raw</code>. Use <code class="literal">none</code>, <code class="literal">headers</code> or <code class="literal">embeddedHeaders</code></li><li class="listitem"><code class="literal">ProducerProperties.partitionKeyExtractorClass</code> in favor of <code class="literal">partitionKeyExtractorName</code> and <code class="literal">ProducerProperties.partitionSelectorClass</code> in favor of <code class="literal">partitionSelectorName</code>.
This is to ensure that both components are Spring configured/managed and referenced in Spring-friendly way.</li><li class="listitem"><code class="literal">BinderAwareRouterBeanPostProcessor</code> - while the component exists it is no longer a Bean Post Processor and will be renamed in the future.</li><li class="listitem"><code class="literal">BinderProperties.setEnvironment(Properties environment)</code> in favor of <code class="literal">BinderProperties.setEnvironment(Map&lt;String, Object&gt; environment)</code>.</li></ul></div><p>This section goes into more detail about how you can work with Spring Cloud Stream.
It covers topics such as creating and running stream applications.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="multi__quick_start_2.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="multi__spring_cloud_stream.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="multi__introducing_spring_cloud_stream.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">25.&nbsp;Quick Start&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="multi_spring-cloud.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;27.&nbsp;Introducing Spring Cloud Stream</td></tr></table></div></body></html>