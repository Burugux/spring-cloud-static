<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>7.&nbsp;Using a KafkaRebalanceListener</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="multi_spring-cloud-stream-binder-kafka.html" title="Spring Cloud Stream Kafka Binder Reference Guide"><link rel="up" href="multi__reference_guide.html" title="Part&nbsp;I.&nbsp;Reference Guide"><link rel="prev" href="multi_kafka-tombstones.html" title="6.&nbsp;Tombstone Records (null record values)"><link rel="next" href="multi_kafka-dlq-processing.html" title="8.&nbsp;Dead-Letter Topic Processing"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.&nbsp;Using a KafkaRebalanceListener</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="multi_kafka-tombstones.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;I.&nbsp;Reference Guide</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="multi_kafka-dlq-processing.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="rebalance-listener" href="#rebalance-listener"></a>7.&nbsp;Using a KafkaRebalanceListener</h2></div></div></div><p>Applications may wish to seek topics/partitions to arbitrary offsets when the partitions are initially assigned, or perform other operations on the consumer.
Starting with version 2.1, if you provide a single <code class="literal">KafkaRebalanceListener</code> bean in the application context, it will be wired into all Kafka consumer bindings.</p><div class="informalexample"><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">interface</span> KafkaBindingRebalanceListener {

	<strong class="hl-tag" style="color: blue">/**
	 * Invoked by the container before any pending offsets are committed.
	 * @param bindingName the name of the binding.
	 * @param consumer the consumer.
	 * @param partitions the partitions.
	 */</strong>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">default</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> onPartitionsRevokedBeforeCommit(String bindingName, Consumer&lt;?, ?&gt; consumer,
			Collection&lt;TopicPartition&gt; partitions) {

	}

	<strong class="hl-tag" style="color: blue">/**
	 * Invoked by the container after any pending offsets are committed.
	 * @param bindingName the name of the binding.
	 * @param consumer the consumer.
	 * @param partitions the partitions.
	 */</strong>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">default</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> onPartitionsRevokedAfterCommit(String bindingName, Consumer&lt;?, ?&gt; consumer, Collection&lt;TopicPartition&gt; partitions) {

	}

	<strong class="hl-tag" style="color: blue">/**
	 * Invoked when partitions are initially assigned or after a rebalance.
	 * Applications might only want to perform seek operations on an initial assignment.
	 * @param bindingName the name of the binding.
	 * @param consumer the consumer.
	 * @param partitions the partitions.
	 * @param initial true if this is the initial assignment.
	 */</strong>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">default</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> onPartitionsAssigned(String bindingName, Consumer&lt;?, ?&gt; consumer, Collection&lt;TopicPartition&gt; partitions,
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">boolean</span> initial) {

	}

}</pre></div><p>You cannot set the <code class="literal">resetOffsets</code> consumer property to <code class="literal">true</code> when you provide a rebalance listener.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="multi_kafka-tombstones.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="multi__reference_guide.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="multi_kafka-dlq-processing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">6.&nbsp;Tombstone Records (null record values)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="multi_spring-cloud-stream-binder-kafka.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;8.&nbsp;Dead-Letter Topic Processing</td></tr></table></div></body></html>